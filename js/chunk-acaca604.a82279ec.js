(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-acaca604"],{"0830":function(t,e,s){t.exports=s.p+"img/top0.13b76951.svg"},"3e96":function(t,e,s){},5360:function(t,e,s){t.exports=s.p+"img/top2.e19b6a72.svg"},"5d16":function(t,e,s){t.exports=s.p+"img/top3.cce3965a.svg"},"77db":function(t,e,s){t.exports=s.p+"img/digits.2818e1c4.png"},"84f4":function(t,e,s){"use strict";s.r(e);var n=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{class:"dao-top10 "+t.theme},[n("div",{staticClass:"header"},[n("div",{staticClass:"title"},[n("span",[t._v(t._s(t.$t("top10.text1")))]),n("span",[t._v(t._s(t.$t("top10.text2")))])]),t._m(0),n("van-button",{attrs:{loading:t.trading,disabled:!t.binded||t.trading||!t.canLottery},on:{click:t.lottery}},[t._v(t._s(t.btnText))])],1),n("div",{staticClass:"top10-list"},[n("div",{staticClass:"tags"},[n("span",{class:{active:"today"===t.tag},on:{click:function(e){t.tag="today"}}},[t._v(t._s(t.$t("top10.text3")))]),n("span",{class:{active:"yesterday"===t.tag},on:{click:function(e){t.tag="yesterday"}}},[t._v(t._s(t.$t("top10.text4")))])]),n("div",{staticClass:"list"},[t._l("today"===t.tag?t.top10:t.yesterdayTop10,(function(e,r){return n("div",{key:e.address,class:["top"+r,{self:e.isSelf}]},[n("div",[r<3?n("img",{attrs:{src:s("8e6c")("./top"+r+".svg")}}):n("div",{staticClass:"digit"},[n("img",{attrs:{src:s("5d16")}}),n("span",{domProps:{textContent:t._s(r+1)}})]),n("span",{domProps:{textContent:t._s(e.address)}})]),n("span",{domProps:{textContent:t._s(e.amount.toFixed(4))}})])})),n("div",{directives:[{name:"show",rawName:"v-show",value:t.binded&&t.connect,expression:"binded && connect"}]},[n("div",[t._m(1),n("span",[t._v(t._s(t.selfAddress))])]),n("span",[t._v(t._s(("today"===t.tag?t.selfAmount:t.yesterdaySelfAmount).toFixed(4)))])])],2)])])},r=[function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"countdown"},[s("div",{staticClass:"digits"},[s("div",{staticClass:"cntDigit",attrs:{id:"cnt_0"}}),s("div",{staticClass:"cntDigit",attrs:{id:"cnt_1"}}),s("span",{staticClass:"cntSeparator"},[t._v(":")]),s("div",{staticClass:"cntDigit",attrs:{id:"cnt_2"}}),s("div",{staticClass:"cntDigit",attrs:{id:"cnt_3"}}),s("span",{staticClass:"cntSeparator"},[t._v(":")]),s("div",{staticClass:"cntDigit",attrs:{id:"cnt_4"}}),s("div",{staticClass:"cntDigit",attrs:{id:"cnt_5"}})])])},function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("img",{attrs:{src:s("9268")}})])}],a=s("1da1"),o=s("5530"),i=(s("96cf"),s("4de4"),s("fb6a"),s("b680"),s("99af"),s("e25e"),s("4795"),{data:function(){return{canLottery:!1,top10:[],yesterdayTop10:[],selfAddress:"",selfAmount:"0",yesterdaySelfAmount:"0",trading:!1,tag:"today"}},computed:Object(o["a"])(Object(o["a"])({},Vuex.mapState(["connect","address","theme","binded"])),{},{btnText:function(){return this.trading?this.$t("top10.text5"):this.canLottery?this.$t("top10.text7"):this.$t("top10.text6")},showSelf:function(){var t="today"===this.tag?this.top10:this.yesterdayTop10;return this.binded&&this.connect&&t.length>0&&0===t.filter((function(t){return t.isSelf})).length}}),created:function(){this.$contracts&&this.init()},methods:{init:function(){var t=this;return Object(a["a"])(regeneratorRuntime.mark((function e(){var s,n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t.selfAddress="0x...".concat(t.$address.slice(-4)),s=new t.$web3.BatchRequest,e.next=4,t.$web3.eth.getBlock("latest");case 4:n=e.sent.timestamp,s.add(t.$contracts.ForceFactory.methods.startTime().call.request({from:t.$address})),s.add(t.$contracts.TopReward.methods.lastLotteryDay().call.request({from:t.$address})),s.add(t.$contracts.TopReward.methods.toDayTopUsers().call.request({from:t.$address})),s.add(t.$contracts.TopReward.methods.toDayTopResults().call.request({from:t.$address})),s.add(t.$contracts.ForceFactory.methods.intervalDayByTime(n).call.request({from:t.$address})),s.requestManager.sendBatch(s.requests,(function(e,s){if(!e){var r=s[1].result.toBN().times(86400).plus("string"===typeof s[0]?s[0]:s[0].result),a=s[2].result.decode(["address[10]"]),o=s[3].result.decode(["uint256[10]"]),i=[];t.initCountdown(r.plus(86400).minus(n).toNumber());for(var c=0;c<a.length;c++)a[c].toBN().gt(0)&&i.push({address:"0x...".concat(a[c].slice(-4)),amount:o[c].fromWei(),isSelf:a[c].toLowerCase()===t.$address.toLowerCase()});t.top10=i;var d=new t.$web3.BatchRequest;d.add(t.$contracts.TopReward.methods.dayUserResults(s[4].result,t.$address).call.request({from:t.$address})),d.add(t.$contracts.TopReward.methods.topUsers(r.minus(1).toFixed()).call.request({from:t.$address})),d.add(t.$contracts.TopReward.methods.topResults(r.minus(1).toFixed()).call.request({from:t.$address})),d.add(t.$contracts.TopReward.methods.dayUserResults(s[4].result.toBN().minus(1).toFixed(),t.$address).call.request({from:t.$address})),d.requestManager.sendBatch(d.requests,(function(e,s){if(!e){for(var n=s[1].result.decode(["address[10]"]),r=s[2].result.decode(["uint256[10]"]),a=[],o=0;o<n.length;o++)n[o].toBN().gt(0)&&a.push({address:"0x...".concat(n[o].slice(-4)),amount:r[o].fromWei(),isSelf:n[o].toLowerCase()===t.$address.toLowerCase()});t.selfAmount=("string"===typeof s[0]?s[0]:s[0].result).fromWei(),t.yesterdayTop10=a,t.yesterdaySelfAmount=s[3].result.fromWei()}}))}}));case 11:case"end":return e.stop()}}),e)})))()},lottery:function(){var t=this;this.$contracts.TopReward.methods.lottery().send({from:this.$address}).on("transactionHash",(function(e){t.trading=!0})).on("receipt",(function(e){vant.Toast.success(t.$t("top10.text8")),t.$emit("reload"),t.init(),t.trading=!1})).on("error",(function(e){t.trading=!1}))},initCountdown:function(t){if(t<=0)return this.countdown("00:00:00"),void(this.canLottery=!0);var e=Math.floor(t/3600),s=Math.floor((t-3600*e)/60),n=t-3600*e-60*s;function r(t){return t<10?"0".concat(t):t}this.countdown("".concat(r(e),":").concat(r(s),":").concat(r(n)))},countdown:function(t){var e=this,n=document.querySelector(".cntDigit"),r={startTime:t,stepTime:60,format:"hh:mm:ss",digitImages:6,digitWidth:n.offsetWidth,digitHeight:n.offsetHeight,timerEnd:function(){},image:s("77db")},a=[],o=[],i=function(){for(var t,e=0,s=0;s<r.startTime.length;s++)if(parseInt(r.startTime[s])>=0){switch(t=document.querySelector("#cnt_".concat(e)),t.current=parseInt(r.startTime[s]),a.push(t),c(e,-t.current*r.digitHeight*r.digitImages),r.format[s]){case"h":a[e]._max=function(t,e){return t%2==0?2:e?3:9};break;case"m":case"s":a[e]._max=function(t){return t%2==0?5:9}}++e}},c=function(t,e){return void 0!==e?(a[t].margin=e,a[t].style.backgroundPosition="0 ".concat(e,"px")):a[t].margin||0},d=function(t,e){var s=arguments.length>2&&void 0!==arguments[2]&&arguments[2];o[t]&&window.clearInterval(o[t]);var n=-r.digitHeight*r.digitImages*a[t].current;c(t,n),a[t].current=a[t].current+(s?e:-e);var i=0;o[t]=setInterval((function(){if(i++===r.digitImages*e)return window.clearInterval(o[t]),void delete o[t];var a=s?-r.digitHeight:r.digitHeight;c(t,n+i*a)}),r.stepTime/e)},u=function t(e){if(0!=a[e].current)d(e,1);else if(e>0){var s=0==a[e-1].current;d(e,a[e]._max(e,s),!0),t(e-1)}else{for(var n=0;n<a.length;n++)clearInterval(o[n]),c(n,0);r.timerEnd()}};i();var l=setInterval((function(){a.filter((function(t){return t.current>0})).length<=0?(e.canLottery=!0,clearInterval(l)):u(a.length-1)}),1e3)}}}),c=i,d=c,u=(s("e202"),s("2877")),l=Object(u["a"])(d,n,r,!1,null,"5a40cfd2",null);e["default"]=l.exports},"8e6c":function(t,e,s){var n={"./top-pool.svg":"ecd8","./top0.svg":"0830","./top1.svg":"e31e","./top2.svg":"5360","./top3.svg":"5d16"};function r(t){var e=a(t);return s(e)}function a(t){if(!s.o(n,t)){var e=new Error("Cannot find module '"+t+"'");throw e.code="MODULE_NOT_FOUND",e}return n[t]}r.keys=function(){return Object.keys(n)},r.resolve=a,t.exports=r,r.id="8e6c"},9268:function(t,e,s){t.exports=s.p+"img/user.fe566d18.svg"},c20d:function(t,e,s){var n=s("da84"),r=s("58a8").trim,a=s("5899"),o=n.parseInt,i=/^[+-]?0[Xx]/,c=8!==o(a+"08")||22!==o(a+"0x16");t.exports=c?function(t,e){var s=r(String(t));return o(s,e>>>0||(i.test(s)?16:10))}:o},e202:function(t,e,s){"use strict";s("3e96")},e25e:function(t,e,s){var n=s("23e7"),r=s("c20d");n({global:!0,forced:parseInt!=r},{parseInt:r})},e31e:function(t,e,s){t.exports=s.p+"img/top1.13783bf9.svg"}}]);