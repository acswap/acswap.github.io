(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-a1472284"],{"058e":function(t,e,s){t.exports=s.p+"img/pledge-mining.83c96ad9.svg"},"41fd":function(t,e,s){},"4acf":function(t,e,s){"use strict";s("1933"),s("d08d")},"6afc":function(t,e,s){t.exports=s.p+"img/nft-mining.444be305.svg"},"76e0":function(t,e,s){t.exports=s.p+"img/history.4d73d81d.svg"},"89b4":function(t,e,s){"use strict";s.r(e);s("d999");var a=function(){var t=this,e=t._self._c;t._self._setupProxy;return e("div",{staticClass:"farms"},[e("div",{staticClass:"header"},[e("div",{staticClass:"income"},[e("div",[e("span",[t._v(t._s(t.$t("mining.text1")))]),e("span",[t._v(t._s(t.totalEarn.toFixed(2)))]),e("button",{on:{click:function(e){return t.$router.push("/farms/log")}}},[e("img",{attrs:{src:s("76e0")}}),e("span",[t._v(t._s(t.$t("mining.text2")))])])]),e("button",{directives:[{name:"show",rawName:"v-show",value:t.isCanTake,expression:"isCanTake"}],on:{click:t.showAward}},[t._v(t._s(t.$t("mining.text3")))]),e("button",{directives:[{name:"show",rawName:"v-show",value:!t.isCanTake,expression:"!isCanTake"}],on:{click:t.distribute}},[e("span",{directives:[{name:"show",rawName:"v-show",value:!t.trading,expression:"!trading"}]},[t._v(t._s(t.$t("renew")))]),e("van-loading",{directives:[{name:"show",rawName:"v-show",value:t.trading,expression:"trading"}]})],1)]),e("div",{staticClass:"amounts"},[e("div",[e("div",[e("img",{attrs:{src:s("fbc4")}}),e("span",[t._v(t._s(t.$t("lp_mining")))])]),e("span",[t._v(t._s(t.earnLP.toFixed(0)))])]),e("div",[e("div",[e("img",{attrs:{src:s("6afc")}}),e("span",[t._v(t._s(t.$t("nft_mining")))])]),e("span",[t._v(t._s(t.earnNFT.toFixed(0)))])]),e("div",[e("div",[e("img",{attrs:{src:s("058e")}}),e("span",[t._v(t._s(t.$t("node_mining")))])]),e("span",[t._v(t._s(t.earnDAO.toFixed(0)))])])])]),e("div",{staticClass:"title"},[e("div",{class:{active:"LP"===t.tag},on:{click:function(e){t.tag="LP"}}},[e("span",[t._v(t._s(t.$t("mining.text7")))])]),e("div",{class:{active:"NFT"===t.tag},on:{click:function(e){t.tag="NFT"}}},[e("span",[t._v(t._s(t.$t("mining.text5")))])]),e("div",{class:{active:"BOARD"===t.tag},on:{click:function(e){t.tag="BOARD"}}},[e("span",[t._v(t._s(t.$t("mining.text8")))])])]),e("lp-mining",{directives:[{name:"show",rawName:"v-show",value:"LP"===t.tag,expression:"tag === 'LP'"}],attrs:{poolsInfo:t.poolsInfo},on:{reload:t.init}}),e("nft-mining",{directives:[{name:"show",rawName:"v-show",value:"NFT"===t.tag,expression:"tag === 'NFT'"}],on:{reload:t.init}}),e("board-mining",{directives:[{name:"show",rawName:"v-show",value:"BOARD"===t.tag,expression:"tag === 'BOARD'"}],on:{reload:t.init}}),e("take-award",{ref:"TakeAward",attrs:{earnLP:t.earnLP,earnNFT:t.earnNFT,earnDAO:t.earnDAO,totalEarn:t.totalEarn,poolsInfo:t.poolsInfo},on:{reload:t.init}})],1)},n=[],i=(s("14b9"),s("d774")),o=(s("4acf"),s("030d")),r=(s("a215"),s("0c68"),s("abfe"),s("815a"),s("ae55"),s("e549")),d=s("b9cc"),c={components:{[o["a"].name]:o["a"],"take-award":()=>s.e("chunk-631e8740").then(s.bind(null,"2443")),"lp-mining":()=>s.e("chunk-3f47a956").then(s.bind(null,"6956")),"nft-mining":()=>s.e("chunk-66b96372").then(s.bind(null,"a4e5")),"board-mining":()=>s.e("chunk-4eb5efe2").then(s.bind(null,"4c64"))},data(){return{tag:"LP",earnNFT:0,earnDAO:0,poolsInfo:[],isCanTake:!1,trading:!1}},computed:{earnLP(){return this.poolsInfo.reduce((t,e)=>t.plus(e.earn),"0".toBN()).toFixed()},totalEarn(){return this.earnLP.toBN().plus(this.earnNFT).plus(this.earnDAO).toFixed()}},created(){this.$contracts&&this.init()},methods:{showAward(){this.$refs.TakeAward.toggle()},async distribute(){this.trading=!0;const t=this.$contracts.Farm.methods.distribute();try{await t.call({from:this.$address}),t.send({from:this.$address}).on("receipt",()=>{i["a"].success(this.$t("renew_successful")),this.init(),this.trading=!1}).on("error",t=>{console.log(t),this.trading=!1})}catch(e){console.log(e),this.trading=!1}},init(){this.$contracts.Farm.methods.poolLength().call((t,e)=>{if(!t){const t=new this.$web3.BatchRequest;for(let s=0;s<+e;s++)t.add(this.$contracts.Farm.methods.pools(s).call.request("latest"));t.requestManager.sendBatch(t.requests,(t,e)=>{if(!t){const t=e.map(t=>(t.result||t).decode(["address"])).filter(t=>!(t.toBN().eq(this.$contracts.AcNFT.options.address.toBN())||t.toBN().eq(this.$contracts.AcDAO.options.address.toBN())));this.getPoolsInfo(t)}})}}),this.$contracts.Farm.methods.earn(this.$contracts.AcNFT.options.address,this.$address).call((t,e)=>{t||(this.earnNFT=e.fromWei())}),this.$contracts.Farm.methods.earn(this.$contracts.AcDAO.options.address,this.$address).call((t,e)=>{t||(this.earnDAO=e.fromWei())}),this.$contracts.Farm.methods.callable().call((t,e)=>{t||(this.isCanTake=!e)})},getPoolsInfo(t){const e=new this.$web3.BatchRequest;e.add(this.$contracts.Farm.methods.getDayOutpus().call.request("latest")),e.add(this.$contracts.AcSwapRouter.methods.getAmountsOut("1".toWei(),[this.$contracts.AcToken.options.address,this.$contracts.USDTToken.options.address]).call.request("latest")),e.add(this.$contracts.Farm.methods.totalRadio().call.request("latest"));for(let s=0;s<t.length;s++){const a=new this.$web3.eth.Contract(r,t[s]);e.add(a.methods.token0().call.request("latest")),e.add(a.methods.token1().call.request("latest")),e.add(this.$contracts.Farm.methods.poolInfo(t[s]).call.request("latest")),e.add(a.methods.balanceOf(this.$contracts.Farm.options.address).call.request("latest")),e.add(this.$contracts.Farm.methods.userInfo(t[s],this.$address).call.request("latest")),e.add(this.$contracts.Farm.methods.earn(t[s],this.$address).call.request("latest"))}e.requestManager.sendBatch(e.requests,async(e,s)=>{if(!e){const e=(s[0].result||s[0]).toBN().div(1e18).times(365),a=s[1].result.decode(["uint256[]"])[1].fromWei(),n=Number(s[2].result),i=[];let o=0;for(let r=3;r<s.length;r+=6){const d=s[r+2].result.decode([{type:"bool",name:"isNft"},{type:"address",name:"token"},{type:"uint256",name:"radio"},{type:"uint256",name:"accTokenPerShare"},{type:"uint256",name:"totalPower"}]),c=s[r+4].result.decode([{type:"uint256",name:"power"},{type:"uint256",name:"reward"},{type:"uint256",name:"taked"},{type:"uint256",name:"rewardDebt"}]),l=e.times(a).times(d.radio);i.push({pair:t[o++],token0:s[r].result.decode(["address"]),token1:s[r+1].result.decode(["address"]),radio:d.radio,totalDeposited:s[r+3].result.fromWei(),deposited:c.power.fromWei(),earn:s[r+5].result.fromWei(),priceAnnualOutput:l,totalRadio:n})}this.poolsInfo=await this.getTokensSymbol(i)}})},getTokensSymbol(t){return new Promise(e=>{const s=new this.$web3.BatchRequest;for(let a=0;a<t.length;a++){const e=new this.$web3.eth.Contract(d,t[a].token0),n=new this.$web3.eth.Contract(d,t[a].token1),i=new this.$web3.eth.Contract(r,t[a].pair);s.add(e.methods.symbol().call.request("latest")),s.add(n.methods.symbol().call.request("latest")),s.add(i.methods.totalSupply().call.request("latest")),s.add(this.$contracts.USDTToken.methods.balanceOf(t[a].pair).call.request("latest"))}s.requestManager.sendBatch(s.requests,(s,a)=>{if(!s){let s=0;for(let e=0;e<a.length;e+=4){const n=(a[e].result||a[e]).decode(["string"]),i=a[e+1].result.decode(["string"]),o=a[e+2].result.fromWei(),r=a[e+3].result.toBN().times(2).div(1e18).div(o),d=r.times(t[s].totalDeposited).times(t[s].totalRadio);t[s]={...t[s],symbol0:n,symbol1:i,symbol:`${n}-${i}/LP`,apy:t[s].priceAnnualOutput.div(d).toFixed(),depositedUSD:r.times(t[s].deposited).toFixed()},s++}e(t)}})})}}},l=c,h=l,u=(s("c0fc"),s("c6fb")),m=Object(u["a"])(h,a,n,!1,null,"23d330e0",null);e["default"]=m.exports},abfe:function(t,e,s){"use strict";var a=s("7636"),n=s("dcab"),i=s("67e7"),o=s("f1a3"),r=s("55d4"),d=s("1707"),c=s("b3e0"),l=s("3310"),h=s("2129"),u=s("565f"),m=s("73b3"),p=!l&&!u("filter",(function(){})),f=!l&&!p&&m("filter",TypeError),g=l||p||f,v=d((function(){var t,e,s,a=this.iterator,i=this.predicate,r=this.next;while(1){if(t=o(n(r,a)),e=this.done=!!t.done,e)return;if(s=t.value,c(a,i,[s,this.counter++],!0))return s}}));a({target:"Iterator",proto:!0,real:!0,forced:g},{filter:function(t){o(this);try{i(t)}catch(e){h(this,"throw",e)}return f?n(f,this,t):new v(r(this),{predicate:t})}})},c0fc:function(t,e,s){"use strict";s("41fd")},fbc4:function(t,e,s){t.exports=s.p+"img/power-mining.b0a26270.svg"}}]);