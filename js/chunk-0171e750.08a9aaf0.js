(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-0171e750"],{"070c":function(t,e,i){"use strict";i.r(e);var s=function(){var t=this,e=t._self._c;t._self._setupProxy;return e("div",{staticClass:"dao"},[e("h2",[t._v(t._s(t.$t("dao_tips.tip1")))]),e("p",[t._v(t._s(t.$t("dao.text2")))]),e("div",{directives:[{name:"show",rawName:"v-show",value:!t.isBinded,expression:"!isBinded"}],staticClass:"bind-container"},[e("div",{staticClass:"bind-content"},[e("h3",[t._v(t._s(t.$t("dao_governance_invitation")))]),e("p",[t._v(t._s(t.$t("dao.text3")))]),e("textarea",{directives:[{name:"model",rawName:"v-model",value:t.inputValue,expression:"inputValue"}],attrs:{placeholder:t.$t("dao.text4")},domProps:{value:t.inputValue},on:{input:function(e){e.target.composing||(t.inputValue=e.target.value)}}}),t._v(" "),e("van-button",{attrs:{disabled:t.trading,loading:t.trading,"loading-text":t.$t("transacting")},on:{click:t.makeRelationDelegate}},[t._v(t._s(t.$t("confirm")))])],1)]),e("div",{directives:[{name:"show",rawName:"v-show",value:t.isBinded,expression:"isBinded"}],staticClass:"binded-container"},[e("div",{staticClass:"info-container"},[e("div",{staticClass:"info-content"},[e("h3",[t._v(t._s(t.$t("dao_governance_invitation")))]),e("p",[t._v(t._s(t.$t("dao.text3")))]),e("div",{staticClass:"info"},[t._m(0),e("div",[e("span",{staticClass:"one"},[t._v("Acorn Role NFT")]),e("span",[t._v("ACORN")]),e("div",{staticClass:"one"},[e("span",[t._v("NFT ID：")]),e("span",{staticClass:"onespan"},[t._v(t._s(t.tokenId))]),e("img",{attrs:{src:i("54ee")},on:{click:function(e){return t.copy(t.tokenId)}}})])])])])]),e("div",{staticClass:"children"},[e("div",{staticClass:"total"},[e("img",{attrs:{src:i("fd74")}}),e("span",[t._v(t._s(t.$t("dao.text8")))]),e("span",[t._v(t._s(t.childrenLength))])]),e("div",{staticClass:"list"},[e("div",{staticClass:"title"},[e("span",[t._v(t._s(t.$t("address")))]),e("span",[t._v(t._s(t.$t("NFT")))])]),e("div",{staticClass:"content"},t._l(t.children,(function(i){return e("div",{key:i.address},[e("span",[t._v(t._s("0x..."+i.address.slice(-4)))]),e("span",[t._v(t._s(i.cardId))])])})),0)])])])])},n=[function(){var t=this,e=t._self._c;t._self._setupProxy;return e("div",{staticClass:"NFTimg"},[e("img",{attrs:{src:i("ab5f"),alt:""}})])}],a=(i("14b9"),i("d774")),r=(i("d999"),{data(){return{isBinded:!1,trading:!1,inputValue:"",inviteLink:"",parentAddress:"",totalAward:0,childrenLength:0,totalSupply:0,parent:0,tokenId:"",children:[]}},computed:{btnText(){return this.trading?this.$t("binding"):this.$t("confirm")}},created(){this.$contracts&&this.init(),this.$route.query.invite&&(this.inputValue=this.$route.query.invite)},methods:{copy(t){this.$copyText(t).then(()=>{a["a"].success(this.$t("copied"))},()=>{a["a"].fail(this.$t("copy_failed"))})},async makeRelationDelegate(){if(console.log(this.inputValue),0==this.inputValue.length)return a["a"].fail(this.$t("dao.text9"));this.$contracts.RoleToken.methods.ownerOf(this.inputValue).call(async(t,e)=>{if(t)return a["a"].fail(this.$t("dao.text9"));this.trading=!0;const i=this.$contracts.Family.methods.createRole(this.inputValue),s={from:this.$address};if(0!==this.chainId)try{const[t]=await Promise.all([this.$web3.eth.getGasPrice()]);s.gasPrice=t}catch(n){s.gasPrice=await this.$web3.eth.getGasPrice()}try{await i.call({from:this.$address})}catch(n){return console.log("Call检查失败:",n),this.trading=!1,a["a"].fail(this.$t("dao.text9"))}try{i.send(s).on("receipt",()=>{this.init(),this.trading=!1,a["a"].success(this.$t("dao.text10"))}).on("error",t=>{console.log(t),this.trading=!1})}catch(n){console.log(n),this.trading=!1}})},async init(){this.$contracts.RoleToken.methods.balanceOf(this.$address).call(async(t,e)=>{t||(this.isBinded=e.toBN().gt(0),this.parent=e)});const t=await this.$contracts.RoleToken.methods.tokenOfOwnerByIndex(this.$address,this.parent).call(),e=await this.$contracts.RoleToken.methods.totalSupply().call();this.totalSupply=e,this.tokenId=t;const i=await this.$contracts.Family.methods.childrenOf(t).call();for(let s=0;s<i.length;s++)this.$contracts.RoleToken.methods.ownerOf(i[s]).call((t,e)=>{t||this.children.push({cardId:i[s],address:e})});this.childrenLength=i.length}}}),o=r,c=o,d=(i("e042"),i("c6fb")),l=Object(d["a"])(c,s,n,!1,null,"766482e6",null);e["default"]=l.exports},"54ee":function(t,e,i){t.exports=i.p+"img/copy.c8f782ac.svg"},"5b85":function(t,e,i){},ab5f:function(t,e,i){t.exports=i.p+"img/NFT1.6a937691.svg"},cd93:function(t,e,i){"use strict";var s=i("f32c");t.exports=Array.isArray||function(t){return"Array"===s(t)}},cef2:function(t,e,i){"use strict";var s=TypeError,n=9007199254740991;t.exports=function(t){if(t>n)throw s("Maximum allowed index exceeded");return t}},d999:function(t,e,i){"use strict";var s=i("7636"),n=i("43d9"),a=i("805d"),r=i("e440"),o=i("cef2"),c=i("b91a"),d=c((function(){return 4294967297!==[].push.call({length:4294967296},1)})),l=function(){try{Object.defineProperty([],"length",{writable:!1}).push()}catch(t){return t instanceof TypeError}},h=d||!l();s({target:"Array",proto:!0,arity:1,forced:h},{push:function(t){var e=n(this),i=a(e),s=arguments.length;o(i+s);for(var c=0;c<s;c++)e[i]=arguments[c],i++;return r(e,i),i}})},e042:function(t,e,i){"use strict";i("5b85")},e440:function(t,e,i){"use strict";var s=i("ac10"),n=i("cd93"),a=TypeError,r=Object.getOwnPropertyDescriptor,o=s&&!function(){if(void 0!==this)return!0;try{Object.defineProperty([],"length",{writable:!1}).length=1}catch(t){return t instanceof TypeError}}();t.exports=o?function(t,e){if(n(t)&&!r(t,"length").writable)throw new a("Cannot set read only .length");return t.length=e}:function(t,e){return t.length=e}},fd74:function(t,e,i){t.exports=i.p+"img/total-children.29101059.svg"}}]);