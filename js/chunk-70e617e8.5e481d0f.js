(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-70e617e8"],{"086e":function(t,s,e){t.exports=e.p+"img/usdt.c20f2f6b.svg"},"488e":function(t,s,e){t.exports=e.p+"img/ac-nft.ba819a52.svg"},"500f":function(t,s,e){t.exports=e.p+"img/nodata.cd108066.svg"},"5e1b":function(t,s,e){t.exports=e.p+"img/nft.9212b8ff.svg"},"65e9":function(t,s,e){t.exports=e.p+"img/X.0b5439eb.svg"},"7e03":function(t,s,e){},"982d":function(t,s,e){},a977:function(t,s,e){t.exports=e.p+"img/ACNFT.5ba3a9af.svg"},ad01:function(t,s,e){},b5a2:function(t,s,e){t.exports=e.p+"img/warning.a3c0de9d.svg"},c251:function(t,s,e){"use strict";e("7e03")},d237:function(t,s,e){"use strict";e("982d")},e8f6:function(t,s,e){"use strict";e("ad01")},e9f1:function(t,s,e){"use strict";e.r(s);var a=function(){var t=this,s=t._self._c;return s("div",{staticClass:"exchange"},[s("h2",[t._v(t._s(t.$t("exchange.text1")))]),s("span",[t._v(t._s(t.$t("exchange.text2")))]),s("span"),s("div",{staticClass:"subscribe"},[s("div",{staticClass:"container"},[s("img",{attrs:{src:e("a977")}}),s("span",{staticClass:"tokenName"},[t._v("Mint NFT")]),s("span",{staticClass:"tokenId"},[t._v("Consortium Node")]),s("div",{staticClass:"price"},[s("span",[t._v(t._s(t.$t("exchange.text3")))]),s("div",[s("img",{attrs:{src:e("086e"),alt:""}}),s("span",[t._v(t._s(t.price)+" ")])])]),s("a-button",{attrs:{disabled:!0}},[t._v(t._s(t.$t("exchange.text4")))])],1)]),s("div",{staticClass:"Mysubscription"},[s("span",[t._v(t._s(t.$t("exchange.text5")))]),t.balanceOf>0?s("div",{staticClass:"nft"},[s("div",{staticClass:"container"},[s("div",{staticClass:"info"},[s("img",{attrs:{src:e("488e")}}),s("div",[s("span",{staticClass:"one"},[t._v("Minted NFTs")]),s("span",[t._v("Consortium Node")]),s("div",{staticClass:"one"},[s("span",[t._v(t._s(t.$t("exchange.text6")))]),s("span",{staticClass:"onespan"},[t._v(t._s(t.balanceOf))])])])]),s("div",{staticClass:"transfer",on:{click:t.showTransferNFTse}},[t._v(t._s(t.$t("exchange.text7")))])])]):s("div",{staticClass:"nodata"},[s("img",{attrs:{src:e("500f"),alt:""}}),s("span",[t._v(t._s(t.$t("exchange.text8")))])])]),s("SubscribeNft",{attrs:{show:t.subscribeshow,price:t.price,WethPrice:t.WethPrice,balanceBNB:t.balanceBNB,balanceUSDT:t.balanceUSDT,WethPriceUSDT:t.WethPriceUSDT},on:{close:t.closeSubscribe,refresh:t.init}}),s("TransferNFTs",{attrs:{show:t.transferNFTs,balanceOf:t.balanceOf},on:{close:t.closetransferNFTs,refresh:t.init}})],1)},i=[],n=e("6eef"),o=function(){var t=this,s=t._self._c;return s("div",{directives:[{name:"show",rawName:"v-show",value:t.show,expression:"show"}],staticClass:"popups",on:{click:t.closePopup}},[s("div",{staticClass:"background",on:{click:function(t){t.stopPropagation()}}},[s("div",{staticClass:"popup-content"},[s("div",{staticClass:"popup-header"},[t._v(t._s(t.$t("exchange.text9")))]),s("div",{staticClass:"popup-body"},[s("div",{staticClass:"info"},[s("img",{attrs:{src:e("488e")}}),s("div",[s("span",{staticClass:"one"},[t._v("Mint NFT")]),s("span",[t._v("Consortium Node")]),s("div",{staticClass:"one"},[s("span",[t._v(t._s(t.$t("exchange.text10")))]),s("span",{staticClass:"onespan"},[t._v("$"+t._s(t.price))])])])]),s("div",{staticClass:"price"},[s("div",[s("span",[t._v(t._s(t.$t("exchange.text11")))]),s("div",{staticClass:"bnboruset"},[s("div",{class:t.isBNB?"active":"active1",on:{click:function(s){t.isBNB=!0}}},[t._v(" BNB ")]),s("div",{class:t.isBNB?"active1":"active",on:{click:function(s){t.isBNB=!1}}},[t._v(" USDT ")])])]),s("div",[s("span",[t._v(t._s(t.$t("exchange.text12")))]),s("div",{staticClass:"balance"},[s("span",[t._v(t._s(t.isBNB?t.WethPrice.toFixed():t.price.toFixed()))]),t.isBNB?s("span",[t._v("($"+t._s(t.price)+")")]):t._e()])]),s("div",[s("span",[t._v(t._s(t.$t("exchange.text13",{symbol:t.isBNB?"BNB":"USDT"})))]),s("div",{staticClass:"balance"},[s("span",[t._v(t._s(t.isBNB?t.balanceBNB.toFixed():t.balanceUSDT.toFixed()))]),t.isBNB?s("span",[t._v(" ($"+t._s(t.isBNB&&t.WethPrice.toFixed())+") ")]):t._e()])])])]),s("a-button",{attrs:{loading:t.loading,type:"primary"},on:{click:t.confirmSubscribe}},[t._v(t._s(t.$t("exchange.text14")))])],1)])])},c=[],r=(e("277a"),e("8d0a")),l={props:{show:{type:Boolean,default:!1},price:{type:[String,Number],default:"0"},WethPrice:{type:[String,Number],default:"0"},WethPriceUSDT:{type:[String,Number],default:"0"},balanceBNB:{type:[String,Number],default:"0"},balanceUSDT:{type:[String,Number],default:"0"}},data(){return{isBNB:!0,loading:!1,allowance:0}},computed:{...Object(n["b"])(["address"])},methods:{closePopup(){this.$emit("close")},refreshPopup(){this.$emit("refresh")},async confirmSubscribe(){if(this.isBNB){if(this.WethPrice>this.balanceBNB)return r["a"].error(this.$t("exchange.text15"));this.loading=!0;const s=this.$contracts.NodeTokenAlliance.methods.purchaseMintByBNB(1),e=Math.floor(1.2*Number(this.WethPrice.toWei())).toString();try{await s.call({from:this.address,value:e}),s.send({from:this.address,value:e}).on("receipt",()=>{this.loading=!1,this.refreshPopup(),r["a"].success(this.$t("exchange.text16")),this.closePopup()}).on("error",t=>{console.log(t),this.loading=!1})}catch(t){console.log(t),this.loading=!1}}else{if(Number(this.price)>Number(this.balanceUSDT))return r["a"].error(this.$t("exchange.text15"));this.approve()}},async purchaseMintByUSD(){this.loading=!0;const t=this.$contracts.NodeTokenAlliance.methods.purchaseMintByUSD(1);try{await t.call({from:this.address}),t.send({from:this.address}).on("receipt",()=>{this.loading=!1,this.refreshPopup(),r["a"].success(this.$t("exchange.text16")),this.closePopup()}).on("error",t=>{console.log(t),this.loading=!1})}catch(s){console.log(s),this.loading=!1}},approve(){this.loading=!0,this.$contracts.USDTToken.methods.approve(this.$contracts.NodeTokenAlliance.options.address,this.price.toWei()).send({from:this.address}).on("receipt",async()=>{const t=await this.$contracts.USDTToken.methods.allowance(this.address,this.$contracts.NodeTokenAlliance.options.address).call({from:this.address});this.allowance=t.fromWei(),this.purchaseMintByUSD(),r["a"].success(this.$t("exchange.text17"))}).on("error",t=>{console.log(t),this.loading=!1})},async transfer(){}}},d=l,h=(e("d237"),e("c6fb")),p=Object(h["a"])(d,o,c,!1,null,"48e19eb2",null),u=p.exports,f=function(){var t=this,s=t._self._c;return s("div",{directives:[{name:"show",rawName:"v-show",value:t.show,expression:"show "}],staticClass:"popups",on:{click:t.closePopup}},[s("div",{staticClass:"background",on:{click:function(t){t.stopPropagation()}}},[s("div",{staticClass:"popup-content"},[s("div",{staticClass:"popup-header"},[t._v(" "+t._s(t.$t("exchange.text18"))+" "),s("img",{attrs:{src:e("65e9"),alt:""},on:{click:t.closePopup}})]),s("div",{staticClass:"popup-body"},[s("div",{staticClass:"info"},[s("img",{attrs:{src:e("5e1b"),alt:""}}),s("div",[s("span",{staticClass:"one"},[t._v("Minted NFTs")]),s("span",[t._v("Consortium Node")]),s("div",{staticClass:"one"},[s("span",[t._v(t._s(t.$t("exchange.text6")))]),s("span",{staticClass:"onespan"},[t._v(t._s(t.balanceOf))])])])]),s("div",{staticClass:"operate"},[s("span",{staticClass:"subtitle"},[t._v(t._s(t.$t("exchange.text19")))]),s("input",{directives:[{name:"model",rawName:"v-model",value:t.amount,expression:"amount"}],attrs:{type:"text",placeholder:t.$t("exchange.text20")},domProps:{value:t.amount},on:{input:function(s){s.target.composing||(t.amount=s.target.value)}}}),s("span",{staticClass:"subtitle"},[t._v(t._s(t.$t("transferNFT.text3")))]),s("input",{directives:[{name:"model",rawName:"v-model",value:t.toAddress,expression:"toAddress"}],attrs:{type:"text",placeholder:t.$t("transferNFT.text4")},domProps:{value:t.toAddress},on:{input:function(s){s.target.composing||(t.toAddress=s.target.value)}}}),s("div",{staticClass:"warning"},[s("img",{attrs:{src:e("b5a2"),alt:""}}),s("span",[t._v(t._s(t.$t("exchange.text21")))])])])]),s("a-button",{attrs:{disabled:t.loading,loading:t.loading,type:"primary"},on:{click:t.confirmTransferNFTs}},[t._v(t._s(t.btnText))])],1)])])},b=[],v={props:{show:{type:Boolean,default:!1},balanceOf:{type:[String,Number],default:"0"}},data(){return{isBNB:!1,loading:!1,toAddress:"",amount:1}},computed:{...Object(n["b"])(["address"]),btnText(){return this.loading?this.$t("transacting"):this.$t("confirm")}},methods:{closePopup(){this.$emit("close")},refreshPopup(){this.$emit("refresh")},async confirmTransferNFTs(){if(0==this.amount)return r["a"].error(this.$t("exchange.text22"));if(Number(this.amount)>Number(this.balanceOf))return r["a"].error(this.$t("exchange.text23"));if(0==this.toAddress.length)return r["a"].error(this.$t("exchange.text24"));if(!this.$web3.utils.isAddress(this.toAddress))return r["a"].error(this.$t("exchange.text25"));this.loading=!0;const t=this.$contracts.NodeTokenAlliance.methods.safeTransferFrom(this.address,this.toAddress,1,this.amount,"0x");try{await t.call({from:this.address}),t.send({from:this.address}).on("receipt",()=>{this.loading=!1,this.refreshPopup(),r["a"].success(this.$t("exchange.text26")),this.closePopup()}).on("error",t=>{console.log(t),this.loading=!1})}catch(s){console.log(s),this.loading=!1}}}},g=v,m=(e("e8f6"),Object(h["a"])(g,f,b,!1,null,"8a30d9b8",null)),x=m.exports,_={components:{SubscribeNft:u,TransferNFTs:x},data(){return{tokenId:0,price:0,WethPrice:0,balanceOf:0,balanceBNB:0,balanceUSDT:0,WethPriceUSDT:0,subscribeshow:!1,transferNFTs:!1}},created(){this.init()},computed:{...Object(n["b"])(["connect","address","chainId"]),btnText(){},blindBox(){}},methods:{async init(){console.log("rec",this.$Aggregation);try{const[t,s,e,a,i]=await Promise.all([this.$web3.eth.getBalance(this.address),this.$contracts.USDTToken.methods.balanceOf(this.address).call(),this.$contracts.NodeTokenAlliance.methods.nodePrice().call(),this.$contracts.NodeTokenAlliance.methods.balanceOf(this.address,1).call(),this.$Aggregation.methods.WETH().call()]);this.balanceBNB=t.fromWei(),this.balanceUSDT=s.fromWei(),this.price=e.fromWei(),this.balanceOf=a;const[n,o]=await Promise.all([this.$Router.methods.getAmountsOut(this.$web3.utils.toWei("1","ether"),["0xbb4CdB9CBd36B01bD1cBaEBF2De08d9173bc095c",this.$contracts.USDTToken.options.address]).call(),this.$Router.methods.getAmountsOut(e,[this.$contracts.USDTToken.options.address,"0xbb4CdB9CBd36B01bD1cBaEBF2De08d9173bc095c"]).call()]);this.WethPriceUSDT=n[1].fromWei(),this.WethPrice=o[1].fromWei()}catch(t){console.error("初始化失败:",t)}},showSubscribe(){this.subscribeshow=!0},showTransferNFTse(){this.transferNFTs=!0},closeSubscribe(){this.subscribeshow=!1},closetransferNFTs(){this.transferNFTs=!1}}},N=_,B=(e("c251"),Object(h["a"])(N,a,i,!1,null,"6b052d46",null));s["default"]=B.exports}}]);