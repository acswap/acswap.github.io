(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-682d9839"],{"0499":function(t,e,s){t.exports=s.p+"img/fsv.7ed356ec.svg"},"2d09":function(t,e,s){"use strict";s.r(e);var n=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{class:"dao-governance "+t.theme},[n("div",{staticClass:"container"},[n("div",{staticClass:"header"},[n("span",[t._v(t._s(t.$t("governance.text1")))]),n("span",[t._v(t._s(t.$t("governance.text2")))])]),n("div",{staticClass:"powers"},[n("div",[n("span",[t._v(t._s(t.$t("governance.text3")))]),n("span",[t._v(t._s(t.burnForce.toFixed()))])]),n("div",[n("span",[t._v(t._s(t.$t("governance.text4")))]),n("span",[t._v(t._s(t.shareForce.toFixed()))])]),n("div",[n("span",[t._v(t._s(t.$t("governance.text5")))]),n("span",[t._v(t._s(t.invalidForce.toFixed()))])])]),n("div",{staticClass:"input-container"},[n("div",{staticClass:"token-info"},[t._m(0),n("span",[t._v(t._s(t.fsvBalance.toFixed(2)))]),n("input",{directives:[{name:"model",rawName:"v-model",value:t.fsvAmount,expression:"fsvAmount"}],attrs:{type:"number",placeholder:"0"},domProps:{value:t.fsvAmount},on:{input:[function(e){e.target.composing||(t.fsvAmount=e.target.value)},t.input]}})]),n("img",{attrs:{src:s("c2fd")}}),n("div",{staticClass:"token-info"},[t._m(1),n("span",[t._v(t._s(t.acBalance.toFixed(2)))]),n("input",{attrs:{type:"number",placeholder:"0",readonly:""},domProps:{value:t.acAmount.toFixed()}})])]),n("span",[t._v("ï½ž"+t._s(t.sumUSD.toFixed())+" USD")]),n("span",[t._v(t._s(t.$t("governance.text7"))+" "),n("span",[t._v(t._s(t.burnGetForce.toFixed()))])]),n("van-button",{attrs:{loading:t.trading,disabled:t.binded&&(t.trading||Number(t.fsvAmount)<=0)},on:{click:t.invest}},[t._v(t._s(t.btnText))])],1)])},o=[function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("img",{attrs:{src:s("0499")}}),n("span",[t._v("FSV")])])},function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("img",{attrs:{src:s("c776")}}),n("span",[t._v("AC")])])}],a=s("1da1"),r=s("3835"),i=s("5530"),c=(s("96cf"),s("a9e3"),s("b680"),s("4795"),s("aca7")),d={data:function(){return{burnForce:"0",shareForce:"0",invalidForce:"0",acBalance:"0",fsvBalance:"0",acAllowance:"0",fsvAllowance:"0",acAmount:"",fsvAmount:"",sumUSD:"0",burnGetForce:"0",inputing:!1,trading:!1}},computed:Object(i["a"])(Object(i["a"])({},Vuex.mapState(["connect","address","theme","binded"])),{},{btnText:function(){return this.binded?this.trading?this.$t("governance.text9"):Number(this.fsvAmount)<=0?this.$t("governance.text10"):this.fsvAmount.toBN().gt(this.fsvAllowance)?this.$t("governance.text11",{symbol:"FSV"}):this.acAmount.toBN().gt(this.acAllowance)?this.$t("governance.text11",{symbol:"AC"}):this.$t("governance.text12"):this.$t("governance.text8")}}),created:function(){this.$contracts&&this.init()},methods:{init:function(){var t=this,e=new this.$web3.BatchRequest;e.add(this.$contracts.Govern.methods.userForceOfBurn(this.$address).call.request({from:this.$address})),e.add(this.$contracts.ForceToken.methods.balanceOf(this.$address).call.request({from:this.$address})),e.add(this.$contracts.Farm.methods.userPoolInfo(c["a"].FORCE,this.$address).call.request({from:this.$address})),e.add(this.$contracts.ACToken.methods.balanceOf(this.$address).call.request({from:this.$address})),e.add(this.$contracts.FSVToken.methods.balanceOf(this.$address).call.request({from:this.$address})),e.add(this.$contracts.ACToken.methods.allowance(this.$address,this.$contracts.Govern.options.address).call.request({from:this.$address})),e.add(this.$contracts.FSVToken.methods.allowance(this.$address,this.$contracts.Govern.options.address).call.request({from:this.$address})),e.requestManager.sendBatch(e.requests,(function(e,s){if(!e){var n=s[2].result.decode([{name:"supply",type:"uint256"},{name:"reward",type:"uint256"},{name:"taked",type:"uint256"},{name:"rewardDebt",type:"uint256"}]);t.burnForce=("string"===typeof s[0]?s[0]:s[0].result).fromWei(),t.invalidForce=s[1].result.fromWei(),t.shareForce=n.supply.toBN().plus(s[1].result).minus("string"===typeof s[0]?s[0]:s[0].result).toFixed().fromWei(),t.acBalance=s[3].result.fromWei(),t.fsvBalance=s[4].result.fromWei(),t.acAllowance=s[5].result.fromWei(),t.fsvAllowance=s[6].result.fromWei()}}))},input:function(){var t=this;if(!this.inputing){if(Number(this.fsvAmount)<=0)return this.acAmount="",this.sumUSD="0",this.burnGetForce="0",void(this.inputing=!1);this.inputing=!0;var e=setTimeout((function(){if(Number(t.fsvAmount)<=0)return t.acAmount="",t.sumUSD="0",t.burnGetForce="0",t.inputing=!1,void clearTimeout(e);t.$contracts.Multicall.methods.aggregate([[t.$contracts.Govern.options.address,t.$contracts.Govern.methods.getForceByToken(t.$contracts.FSVToken.options.address,t.fsvAmount.toWei(),t.$address).encodeABI()],[t.$contracts.Oracle.options.address,t.$contracts.Oracle.methods.getTokenPrice(t.$contracts.FSVToken.options.address,"1".toWei()).encodeABI()],[t.$contracts.Oracle.options.address,t.$contracts.Oracle.methods.getTokenPrice(t.$contracts.ACToken.options.address,"1".toWei()).encodeABI()]]).call({from:t.$address},(function(s,n){if(!s){if(Number(t.fsvAmount)<=0)return t.acAmount="",t.sumUSD="0",t.burnGetForce="0",t.inputing=!1,void clearTimeout(e);var o=Object(r["a"])(n.returnData,3),a=o[0],i=o[1],c=o[2],d=a.decode([{name:"burnGetForce",type:"uint256"},{name:"acAmount",type:"uint256"}]),u=d.burnGetForce,l=d.acAmount;t.burnGetForce=u.fromWei(),t.acAmount=l.fromWei(),t.sumUSD=i.toBN().times(t.fsvAmount).plus(c.toBN().times(l.fromWei())).toFixed().fromWei(),t.inputing=!1,clearTimeout(e)}}))}),1e3)}},approve:function(t){var e=this,s=this.$contracts["".concat(t,"Token")],n=("FSV"===t?this.fsvAmount:this.acAmount).toBN().times(10).toFixed().toWei();s.methods.approve(this.$contracts.Govern.options.address,n).send({from:this.$address}).on("transactionHash",(function(t){e.trading=!0})).on("receipt",function(){var n=Object(a["a"])(regeneratorRuntime.mark((function n(o){var a;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.next=2,s.methods.allowance(e.$address,e.$contracts.Govern.options.address).call({from:e.$address});case 2:a=n.sent,e["FSV"===t?"fsvAllowance":"acAllowance"]=a.fromWei(),vant.Toast.success(e.$t("governance.text13")),e.trading=!1;case 6:case"end":return n.stop()}}),n)})));return function(t){return n.apply(this,arguments)}}()).on("error",(function(t){e.trading=!1}))},invest:function(){var t=this;if(this.binded)if(this.fsvAmount.toBN().gt(this.fsvBalance))vant.Toast.fail(this.$t("governance.text14",{symbol:"FSV"}));else if(this.acAmount.toBN().gt(this.acBalance))vant.Toast.fail(this.$t("governance.text14",{symbol:"AC"}));else{if(this.fsvAmount.toBN().gt(this.fsvAllowance))return this.approve("FSV");if(this.acAmount.toBN().gt(this.acAllowance))return this.approve("AC");console.log(this.$contracts.FSVToken.options.address),console.log(this.fsvAmount),console.log(this.$address);var e=this.$contracts.Govern.methods.invest(this.$contracts.FSVToken.options.address,this.fsvAmount.toWei(),this.$address);e.call({from:this.$address},(function(s,n){s||e.send({from:t.$address}).on("transactionHash",(function(e){t.trading=!0})).on("receipt",(function(e){vant.Toast.success(t.$t("governance.text15")),t.$emit("reload"),t.fsvAmount="",t.acAmount="",t.burnGetForce="0",t.trading=!1})).on("error",(function(e){t.trading=!1}))}))}else this.$emit("showBind")}}},u=d,l=u,m=(s("b795"),s("2877")),v=Object(m["a"])(l,n,o,!1,null,"1f578d7e",null);e["default"]=v.exports},4072:function(t,e,s){},b795:function(t,e,s){"use strict";s("4072")},c2fd:function(t,e,s){t.exports=s.p+"img/plus-green.9e34cd9f.svg"},c776:function(t,e,s){t.exports=s.p+"img/nft-token.898f6260.svg"}}]);