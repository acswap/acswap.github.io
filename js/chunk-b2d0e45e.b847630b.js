(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-b2d0e45e"],{1e3:function(t,s,e){},"16f7":function(t,s,e){t.exports=e.p+"img/nft-empty.2ab13a23.svg"},"26f7":function(t,s,e){"use strict";e.r(s);var i=function(){var t=this,s=t._self._c;t._self._setupProxy;return s("div",{directives:[{name:"show",rawName:"v-show",value:t.show,expression:"show"}],staticClass:"popups"},[s("div",{staticClass:"nft-pledge"},[s("div",{staticClass:"header"},[s("span",[t._v(t._s(t.$t("nftPledge.text1")))]),s("van-icon",{attrs:{name:"cross"},on:{click:t.toggle}})],1),s("span",[t._v(t._s(t.$t("nftPledge.text2")))]),s("div",{staticClass:"nft-list"},[s("div",{directives:[{name:"show",rawName:"v-show",value:t.list.length<=0,expression:"list.length <= 0"}],staticClass:"empty"},[s("img",{attrs:{src:e("16f7")}}),s("span",[t._v(t._s(t.$t("nftPledge.text3")))])]),s("div",{directives:[{name:"show",rawName:"v-show",value:t.list.length>0,expression:"list.length > 0"}],staticClass:"list-container"},t._l(t.list,(function(i){return s("div",{key:i.id,staticClass:"list-item"},[s("div",{staticClass:"checkbox",on:{click:function(t){i.checked=!i.checked}}},[s("img",{directives:[{name:"show",rawName:"v-show",value:i.checked,expression:"item.checked"}],attrs:{src:e("d909")}})]),s("span",[t._v("#"),s("span",[t._v(t._s(i.id))])])])})),0)]),s("div",{staticClass:"all-in"},[s("div",{staticClass:"checkbox",on:{click:t.checkAll}},[s("img",{directives:[{name:"show",rawName:"v-show",value:t.isCheckAll,expression:"isCheckAll"}],attrs:{src:e("d909")}})]),s("span",[t._v(t._s(t.$t("nftPledge.text4")))])]),s("van-button",{attrs:{disabled:t.disabled,loading:t.trading,"loading-text":t.$t("transacting")},on:{click:t.depositNFT}},[t._v(t._s(t.btnText))])],1)])},a=[],c=(e("14b9"),e("d774")),n=(e("6b4d"),e("8cdf")),r=(e("0c68"),e("abfe"),e("815a"),{components:{[n["a"].name]:n["a"]},data(){return{show:!1,list:[],isApproved:!1,trading:!1,address:this.$address}},computed:{disabled(){return this.trading||0===this.checkedNFTList.length},btnText(){return 0===this.checkedNFTList.length?this.$t("nftPledge.text6"):this.isApproved?this.$t("confirm"):this.$t("approve")},isCheckAll(){return 0!==this.list.length&&this.checkedNFTList.length===this.list.length},checkedNFTList(){return this.list.filter(t=>t.checked)}},created(){this.$contracts&&this.init()},methods:{init(){this.$contracts.AcNFT.methods.balanceOf(this.$address).call((t,s)=>{t||this.getNFTList(Number(s))}),this.$contracts.AcNFT.methods.isApprovedForAll(this.$address,this.$contracts.Farm.options.address).call((t,s)=>{t||(this.isApproved=s)})},checkAll(){this.list=this.list.map(t=>({...t,checked:!this.isCheckAll}))},toggle(){this.show=!this.show},setApprovalForAll(){this.trading=!0,this.$contracts.AcNFT.methods.setApprovalForAll(this.$contracts.Farm.options.address,!0).send({from:this.$address}).on("receipt",()=>{c["a"].success(this.$t("nftPledge.text9")),this.isApproved=!0,this.trading=!1,this.depositNFT()}).on("error",t=>{this.trading=!1,console.log(t)})},async depositNFT(){if(!this.isApproved)return this.setApprovalForAll();this.trading=!0;const t=this.$contracts.Farm.methods.deposit(this.$contracts.AcNFT.options.address,this.checkedNFTList.map(t=>t.id));try{await t.call({from:this.$address}),t.send({from:this.$address}).on("receipt",()=>{this.$emit("reload"),c["a"].success(this.$t("nftPledge.text10")),this.trading=!1}).on("error",t=>{this.trading=!1,console.log(t)})}catch(s){this.trading=!1,console.log(s)}},getNFTList(t){if(0===t)return void(this.list=[]);const s=new this.$web3.BatchRequest;for(let e=0;e<t;e++)s.add(this.$contracts.AcNFT.methods.tokenOfOwnerByIndex(this.$address,e).call.request("latest"));s.requestManager.sendBatch(s.requests,(t,s)=>{t||(this.list=s.map(t=>({id:(t.result||t).decode(["uint256"]),checked:!1})))})}}}),d=r,o=d,l=(e("bde2"),e("c6fb")),h=Object(l["a"])(o,i,a,!1,null,"281dc324",null);s["default"]=h.exports},"6b4d":function(t,s,e){"use strict";e("1933"),e("fab4"),e("f952")},bde2:function(t,s,e){"use strict";e("1000")},d909:function(t,s,e){t.exports=e.p+"img/checked.f599428c.svg"}}]);