(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-14467247"],{"16f7":function(t,e,s){t.exports=s.p+"img/nft-empty.a7e47f62.svg"},"26f7":function(t,e,s){"use strict";s.r(e);var i=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{directives:[{name:"show",rawName:"v-show",value:t.show,expression:"show"}],staticClass:"popups"},[i("div",{class:"nft-pledge "+t.theme},[i("div",{staticClass:"header"},[i("span",[t._v(t._s(t.$t("nftPledge.text1")))]),i("van-icon",{attrs:{name:"cross"},on:{click:t.toggle}})],1),i("span",[t._v(t._s(t.$t("nftPledge.text2")))]),i("div",{staticClass:"nft-list"},[i("div",{directives:[{name:"show",rawName:"v-show",value:t.list.length<=0,expression:"list.length <= 0"}],staticClass:"empty"},[i("img",{attrs:{src:s("16f7")}}),i("span",[t._v(t._s(t.$t("nftPledge.text3")))])]),i("div",{directives:[{name:"show",rawName:"v-show",value:t.list.length>0,expression:"list.length > 0"}],staticClass:"list-container"},t._l(t.list,(function(e){return i("div",{key:e.id,staticClass:"list-item"},[i("div",{staticClass:"checkbox",on:{click:function(t){e.checked=!e.checked}}},[i("img",{directives:[{name:"show",rawName:"v-show",value:e.checked,expression:"item.checked"}],attrs:{src:s("d909")}})]),i("span",[t._v("#"),i("span",[t._v(t._s(e.id))])])])})),0)]),i("div",{staticClass:"all-in"},[i("div",{staticClass:"checkbox",on:{click:t.checkAll}},[i("img",{directives:[{name:"show",rawName:"v-show",value:t.isCheckAll,expression:"isCheckAll"}],attrs:{src:s("d909")}})]),i("span",[t._v(t._s(t.$t("nftPledge.text4")))])]),i("button",{staticClass:"ant-btn",attrs:{loading:t.trading,disabled:t.trading||0===t.checkedNFTList.length},on:{click:t.depositNFT}},[t._v(t._s(t.btnText))])])])},n=[],a=s("1da1"),c=s("5530"),r=(s("96cf"),s("4de4"),s("a9e3"),s("d81d"),s("aca7")),o={data:function(){return{show:!1,list:[],isApproved:!1,trading:!1,address:this.$address}},computed:Object(c["a"])(Object(c["a"])({},Vuex.mapState(["contracts","address","theme"])),{},{btnText:function(){return this.trading?this.$t("nftPledge.text5"):0===this.checkedNFTList.length?this.$t("nftPledge.text6"):this.isApproved?this.$t("nftPledge.text8"):this.$t("nftPledge.text7")},isCheckAll:function(){return 0!==this.list.length&&this.checkedNFTList.length===this.list.length},checkedNFTList:function(){return this.list.filter((function(t){return t.checked}))}}),created:function(){this.$contracts&&this.init()},methods:{init:function(){var t=this;return Object(a["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:t.$contracts.AcNft.methods.balanceOf(t.$address).call({from:t.$address},(function(e,s){e||t.getNFTList(Number(s))})),t.$contracts.AcNft.methods.isApprovedForAll(t.$address,t.$contracts.Farm.options.address).call({from:t.$address},(function(e,s){e||(t.isApproved=s)}));case 2:case"end":return e.stop()}}),e)})))()},checkAll:function(){var t=this;this.list=this.list.map((function(e){return Object(c["a"])(Object(c["a"])({},e),{},{checked:!t.isCheckAll})}))},toggle:function(){this.show=!this.show},setApprovalForAll:function(){var t=this;this.$contracts.AcNft.methods.setApprovalForAll(this.$contracts.Farm.options.address,!0).send({from:this.$address}).on("transactionHash",(function(e){t.trading=!0})).on("receipt",(function(e){vant.Toast.success(t.$t("nftPledge.text9")),t.isApproved=!0,t.trading=!1})).on("error",(function(e){t.trading=!1}))},depositNFT:function(){var t=this;if(!this.isApproved)return this.setApprovalForAll();var e=this.$contracts.Farm.methods.depositNFT(r["b"].NFT,this.checkedNFTList.map((function(t){return t.id})),this.$address);e.call({from:this.$address},(function(s,i){s||e.send({from:t.$address}).on("transactionHash",(function(e){t.trading=!0})).on("receipt",(function(e){vant.Toast.success(t.$t("nftPledge.text10")),t.$emit("reload"),t.trading=!1})).on("error",(function(e){t.trading=!1}))}))},getNFTList:function(t){var e=this;if(0!==t){for(var s=new this.$web3.BatchRequest,i=0;i<t;i++)s.add(this.$contracts.AcNft.methods.tokenOfOwnerByIndex(this.$address,i).call.request({from:this.$address}));s.requestManager.sendBatch(s.requests,(function(t,s){t||(e.list=s.map((function(t){return{id:t.result.decode(["uint256"]),checked:!1}})))}))}else this.list=[]}}},d=o,l=d,h=(s("a367"),s("2877")),u=Object(h["a"])(l,i,n,!1,null,"08025d1a",null);e["default"]=u.exports},a367:function(t,e,s){"use strict";s("e65b")},d909:function(t,e,s){t.exports=s.p+"img/checked.7169b113.svg"},e65b:function(t,e,s){}}]);