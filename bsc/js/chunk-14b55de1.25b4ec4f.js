(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-14b55de1"],{"083f":function(t,e,s){t.exports=s.p+"img/childs.2aed3640.svg"},"1eb2":function(t,e,s){"use strict";s("79c9")},"5bef":function(t,e,s){t.exports=s.p+"img/dao-copy.0f22e510.svg"},"79c9":function(t,e,s){},"991b":function(t,e,s){"use strict";s.r(e);var a=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{class:"dao-community "+t.theme},[a("div",{directives:[{name:"show",rawName:"v-show",value:!t.binded,expression:"!binded"}],staticClass:"bind"},[t._m(0),a("input",{directives:[{name:"model",rawName:"v-model",value:t.superior,expression:"superior"}],attrs:{type:"text",placeholder:"输入邀请地址"},domProps:{value:t.superior},on:{input:function(e){e.target.composing||(t.superior=e.target.value)}}}),a("van-button",{attrs:{loading:t.trading,disabled:t.trading},on:{click:t.makeRelation}},[t._v(t._s(t.trading?"区块确认中":"确认"))])],1),a("div",{directives:[{name:"show",rawName:"v-show",value:t.binded,expression:"binded"}],staticClass:"info"},[t._m(1),a("div",{staticClass:"content"},[a("div",[a("span",[t._v("推荐链接：")]),a("div",[a("span",[t._v(t._s(t.inviteLink))]),a("img",{attrs:{src:s("5bef")}})])]),a("div",[a("span",[t._v("邀请地址：")]),a("div",[a("span",[t._v(t._s(t.address))]),a("img",{attrs:{src:s("5bef")}})])])])]),a("div",{directives:[{name:"show",rawName:"v-show",value:t.binded,expression:"binded"}],staticClass:"details"},[a("div",[a("span",[t._v("累计参与$")]),a("span",[t._v(t._s(t.totalDeposit))])]),a("div",[a("span",[t._v("推荐奖励比例")]),a("span",[t._v(t._s(t.selfRadio))])])]),a("div",{directives:[{name:"show",rawName:"v-show",value:t.binded,expression:"binded"}],staticClass:"community-list"},[a("div",{staticClass:"header"},[a("img",{attrs:{src:s("083f")}}),a("span",[t._v("已推荐地址 "),a("span",[t._v(t._s(t.list.length))])])]),a("div",{staticClass:"list"},[t._m(2),t._l(t.list,(function(e){return a("div",{key:e.address},[a("span",[t._v(t._s(e.address))]),a("span",[t._v(t._s(e.force))])])}))],2)])])},i=[function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"header"},[s("span",[t._v("DAO治理邀请")]),s("span",[t._v("邀请好友来参与DAO治理，最高获得30%算力奖励！")])])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"header"},[s("span",[t._v("DAO治理邀请")]),s("span",[t._v("邀请好友来参与DAO治理，最高获得30%算力奖励！")])])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",[s("span",[t._v("地址")]),s("span",[t._v("算力")])])}],n=s("1da1"),r=s("3835"),o=s("5530"),d=(s("96cf"),s("99af"),s("d81d"),s("fb6a"),[{initialValue:0,selfRadio:"70%"},{initialValue:1e3,selfRadio:"80%"},{initialValue:2e3,selfRadio:"90%"}]),c={data:function(){return{rootAddress:"",totalDeposit:"0",selfRadio:"70%",superior:"",trading:!1,inviteLink:"",list:[]}},computed:Object(o["a"])({},Vuex.mapState(["theme","binded"])),created:function(){this.$contracts&&this.init(),this.$route.query.invite&&(this.$emit("showBind"),this.superior=this.$route.query.invite)},methods:{init:function(){var t=this;this.inviteLink="".concat(location.href,"?invite=").concat(this.address),this.$contracts.Multicall.methods.aggregate([[this.$contracts.Family.options.address,this.$contracts.Family.methods.rootAddress().encodeABI()],[this.$contracts.Family.options.address,this.$contracts.Family.methods.parentOf(this.$address).encodeABI()],[this.$contracts.Family.options.address,this.$contracts.Family.methods.childrenOf(this.$address).encodeABI()],[this.$contracts.Govern.options.address,this.$contracts.Govern.methods.userResults(this.$address).encodeABI()]]).call({from:this.$address},(function(e,s){if(!e){var a=Object(r["a"])(s.returnData,4),i=a[0],n=a[1],o=a[2],c=a[3],l=o.decode(["address[]"]);t.rootAddress=i.decode(["address"]).toLowerCase(),t.$store.commit("setBinded",n.toBN().gt(0)),t.totalDeposit=c.fromWei();for(var u=0;u<d.length;u++)t.totalDeposit.toBN().gt(d[u].initialValue)&&(t.selfRadio=d[u].selfRadio);l.length>0&&t.$contracts.Multicall.methods.aggregate(l.map((function(e){return[t.$contracts.ForceToken.options.address,t.$contracts.ForceToken.methods.balanceOf(e).encodeABI()]}))).call({from:t.$address},(function(e,s){e||(t.list=s.returnData.map((function(t,e){return{address:"0x...".concat(l[e].slice(-4)),force:t.fromWei()}})))}))}}))},makeRelation:function(){var t=this;return Object(n["a"])(regeneratorRuntime.mark((function e(){var s,a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(t.$web3.utils.isAddress(t.superior)){e.next=4;break}return e.abrupt("return",vant.Toast.fail("邀请地址不正确！"));case 4:if(t.superior.toLowerCase()===t.rootAddress){e.next=10;break}return e.next=7,t.$contracts.Family.methods.parentOf(t.superior).call({from:t.$address});case 7:if(s=e.sent,!s.toBN().lte(0)){e.next=10;break}return e.abrupt("return",vant.Toast.fail("邀请地址不正确！"));case 10:a=t.$contracts.Family.methods.makeRelation(t.superior),a.call({from:t.$address},(function(e,s){e||a.send({from:t.$address}).on("transactionHash",(function(e){t.trading=!0})).on("receipt",(function(e){vant.Toast.success("邀请成功！"),t.$emit("reload"),t.init(),t.trading=!1})).on("error",(function(e){t.trading=!1}))}));case 12:case"end":return e.stop()}}),e)})))()}}},l=c,u=l,v=(s("1eb2"),s("2877")),p=Object(v["a"])(u,a,i,!1,null,"1f406050",null);e["default"]=p.exports},d81d:function(t,e,s){"use strict";var a=s("23e7"),i=s("b727").map,n=s("1dde"),r=n("map");a({target:"Array",proto:!0,forced:!r},{map:function(t){return i(this,t,arguments.length>1?arguments[1]:void 0)}})}}]);