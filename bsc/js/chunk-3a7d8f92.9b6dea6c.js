(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-3a7d8f92"],{"1bc1":function(t,n,e){"use strict";e.r(n);var a=function(){var t=this,n=t.$createElement,e=t._self._c||n;return e("van-overlay",{directives:[{name:"show",rawName:"v-show",value:t.show,expression:"show"}],on:{click:t.toggle}},[e("div",{class:"board-pledge "+t.theme,on:{click:function(t){t.stopPropagation()}}},[e("div",{staticClass:"header"},[e("span",[t._v("质押BOD代币")]),e("van-icon",{attrs:{name:"cross"},on:{click:t.toggle}})],1),e("span",[t._v("参与质押")]),e("div",{staticClass:"amount"},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.amount,expression:"amount"}],attrs:{type:"number",placeholder:"输入数量"},domProps:{value:t.amount},on:{input:function(n){n.target.composing||(t.amount=n.target.value)}}}),e("span",[t._v("BOD")]),e("a-button",{on:{click:function(n){t.amount=t.balance}}},[t._v("最大")])],1),e("span",[t._v("余额 "),e("span",[t._v(t._s(t.balance))]),t._v(" BOD")]),e("a-button",{attrs:{loading:t.trading,disabled:t.trading||Number(t.amount)<=0},on:{click:t.depositBoard}},[t._v(t._s(t.btnText))])],1)])},o=[],s=e("1da1"),r=e("5530"),i=(e("96cf"),e("a9e3"),e("4de4"),e("b680"),e("aca7")),c={data:function(){return{show:!1,amount:"",balance:"0",allowance:"0",trading:!1}},computed:Object(r["a"])(Object(r["a"])({},Vuex.mapState(["contracts","address","theme"])),{},{btnText:function(){return this.trading?"区块确认中":Number(this.amount)<=0?"输入数量":this.amount.toBN().gt(this.allowance)?"授权":"确认"},isCheckAll:function(){return 0!==this.list.length&&this.checkedNFTList.length===this.list.length},checkedNFTList:function(){return this.list.filter((function(t){return t.checked}))}}),created:function(){this.$contracts&&this.init()},methods:{init:function(){var t=this;return Object(s["a"])(regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:t.$contracts.BoardToken.methods.balanceOf(t.address).call({from:t.address},(function(n,e){n||(t.balance=e.fromWei())})),t.$contracts.BoardToken.methods.allowance(t.address,t.$contracts.Farm.options.address).call({from:t.address},(function(n,e){n||(t.allowance=e.fromWei())}));case 2:case"end":return n.stop()}}),n)})))()},approve:function(){var t=this;this.$contracts.BoardToken.methods.approve(this.$contracts.Farm.options.address,this.amount.toBN().times(10).toFixed().toWei()).send({from:this.address}).on("transactionHash",(function(n){t.trading=!0})).on("receipt",function(){var n=Object(s["a"])(regeneratorRuntime.mark((function n(e){var a;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.next=2,t.$contracts.BoardToken.methods.allowance(t.address,t.$contracts.Farm.options.address).call({from:t.address});case 2:a=n.sent,t.allowance=a.fromWei(),vant.Toast.success("授权成功！"),t.trading=!1;case 6:case"end":return n.stop()}}),n)})));return function(t){return n.apply(this,arguments)}}()).on("error",(function(n){t.trading=!1}))},toggle:function(){this.show=!this.show},depositBoard:function(){var t=this;if(this.amount.toBN().gt(this.allowance))return this.approve();var n=this.$contracts.Farm.methods.depositBoard(i["b"].BOARD,this.amount.toWei(),this.address);n.call({from:this.address},(function(e,a){e||n.send({from:t.address}).on("transactionHash",(function(n){t.trading=!0})).on("receipt",(function(n){t.$emit("reload"),t.init(),t.amount="",t.trading=!1})).on("error",(function(n){t.trading=!1}))}))}}},d=c,u=d,l=(e("43485"),e("2877")),h=Object(l["a"])(u,a,o,!1,null,"c5377c84",null);n["default"]=h.exports},"3c22":function(t,n,e){},43485:function(t,n,e){"use strict";e("3c22")}}]);